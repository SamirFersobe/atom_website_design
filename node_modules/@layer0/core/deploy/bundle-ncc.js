"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
/* istanbul ignore file */
const shelljs_1 = __importDefault(require("shelljs"));
/**
 * Bundles an app info a single JS file with @vercel/ncc. This helps minimize the size of the lambda because of
 * it's efficient tree shaking. This can be a solution when your app is too large to fit within
 * the maximum size of a lambda.
 * @param src The entry point source file
 * @param destDir The output directory
 */
async function bundleWithNcc(src, destDir) {
    console.log('> Bundling your app with @vercel/ncc...');
    loadNcc();
    await shelljs_1.default.exec(`ncc build -m -o ${destDir} ${src}`);
    console.log('> done.');
}
exports.default = bundleWithNcc;
function loadNcc() {
    try {
        require('@vercel/ncc');
    }
    catch (e) {
        console.log('Required dependency @vercel/ncc not found. Install @vercel/ncc@^0.34.0 as a devDependency then retry this command.');
        process.exit(1);
    }
}
