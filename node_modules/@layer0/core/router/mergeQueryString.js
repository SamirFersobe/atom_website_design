"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Used to create URL instance with just a path
 */
const PLACEHOLDER_HOSTNAME = '__';
function mergeQueryString(requestUrl, targetRedirectOrPath) {
    // `https://${PLACEHOLDER_HOSTNAME}` is temporarily inserted to make the `URL` object work
    // with relative path, but is removed from the returned value right after.
    const requestSearchParams = new URL(requestUrl, `https://${PLACEHOLDER_HOSTNAME}`).searchParams;
    const targetUrl = new URL(targetRedirectOrPath, `https://${PLACEHOLDER_HOSTNAME}`);
    // Apply query string from request to the target, except if they are already set explicitly on the target
    requestSearchParams.forEach((value, key) => {
        if (!targetUrl.searchParams.get(key)) {
            targetUrl.searchParams.set(key, value);
        }
    });
    // Keep the target as initially intended, absolute or relative path
    return targetUrl.hostname === PLACEHOLDER_HOSTNAME
        ? `${targetUrl.pathname}${targetUrl.search}`
        : targetUrl.toString();
}
exports.default = mergeQueryString;
