"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const createRouteMock_1 = __importDefault(require("./createRouteMock"));
const constants_1 = require("../../constants");
const ports_1 = require("../../utils/ports");
/**
 * Runs the provided path against the router, returning the mocked response
 * @param router A router instance
 * @param path The path, or result from `createRouteMock`, to run on the router
 * @returns Promise<MockResponse>
 */
async function runRoute(router, path) {
    let request, response;
    if (typeof path === 'string') {
        ;
        ({ request, response } = createRouteMock_1.default(path));
    }
    else {
        ;
        ({ request, response } = path);
    }
    router
        .setBackend(constants_1.BACKENDS.permanentStatic, {
        domainOrIp: ports_1.localhost,
        port: ports_1.assetPort,
    })
        .setBackend(constants_1.BACKENDS.static, {
        domainOrIp: ports_1.localhost,
        port: ports_1.assetPort,
    })
        .setBackend(constants_1.BACKENDS.js, { domainOrIp: ports_1.localhost, port: ports_1.jsPort });
    // @ts-ignore
    await router.run(request, response);
    return response;
}
exports.default = runRoute;
